# Training Diffusion Models with Reinforcement Learning

**Authors**: Kevin Black, Michael Janner, Yilun Du, Ilya Kostrikov, Sergey Levine

**Published**: 2023-05-22

**arXiv**: [2305.13301](https://arxiv.org/abs/2305.13301)

**GitHub**: [https://github.com/jannerm/ddpo](https://github.com/jannerm/ddpo) ‚≠ê 529 üîÄ 33

**Twitter**: [Announcement Tweet](https://x.com/svlevine/status/1660707076946141184) ‚ù§Ô∏è 823 üîÑ 177 üëÅÔ∏è 129,377

**Relevance Score**: 39.2/100

**Domains**: policy_methods, rl

**Tags**: `diffusion`, `RL`, `policy`, `UC-Berkeley`

---

## Summary

Diffusion models are a class of flexible generative models trained with an approximation to the log-likelihood objective. However, most use cases of diffusion models are not concerned with likelihoods, but instead with downstream objectives such as human-perceived image quality or drug effectiveness. In this paper, we investigate reinforcement learning methods for directly optimizing diffusion models for such objectives. We describe how posing denoising as a multi-step decision-making problem enables a class of policy gradient algorithms, which we refer to as denoising diffusion policy optimization (DDPO), that are more effective than alternative reward-weighted likelihood approaches. Empirically, DDPO is able to adapt text-to-image diffusion models to objectives that are difficult to express via prompting, such as image compressibility, and those derived from human feedback, such as aesthetic quality. Finally, we show that DDPO can improve prompt-image alignment using feedback from a vision-language model without the need for additional data collection or human annotation. The project's website can be found at http://rl-diffusion.github.io .
